{"config":{"lang":["fr"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"IaC AWS - Olympic Tracker Documentation","text":"<p>Bienvenue sur la documentation technique du projet IaC AWS - Olympic Tracker.</p>"},{"location":"#objectifs-du-projet","title":"Objectifs du projet","text":"<p>Ce projet d\u00e9montre un workflow DevOps complet int\u00e9grant la Haute Disponibilit\u00e9 (HA) et l'Observabilit\u00e9 :</p> <ul> <li>Infrastructure as Code : Terraform pour le multi-tiering.</li> <li>Gestion de configuration : Ansible (R\u00f4les, ProxyJump SSH &amp; modern facts access).</li> <li>Load Balancing : HAProxy avec r\u00e9partition Round Robin et Forwarding d'IP r\u00e9elle (X-Forwarded-For).</li> <li>Conteneurisation : Docker avec redirection des logs via le driver GELF.</li> <li>Observabilit\u00e9 : Centralisation et analyse via la Stack ELK (Elasticsearch, Logstash, Kibana).</li> </ul>"},{"location":"#architecture-reseau-data","title":"\ud83c\udfd7\ufe0f Architecture R\u00e9seau &amp; Data","text":"<p>Le d\u00e9ploiement suit un flux optimis\u00e9 :</p> <ol> <li>Terraform : Cr\u00e9ation du cluster (1 LB + X Apps + 1 ELK).</li> <li>Local : G\u00e9n\u00e9ration de l'inventaire Ansible incluant les directives <code>ProxyJump</code> pour le bastion.</li> <li>Ansible :</li> <li>D\u00e9ploiement de l'app avec envoi des logs vers Logstash (UDP 12201).</li> <li>Configuration du Load Balancer et de la Stack ELK sur des instances d\u00e9di\u00e9es.</li> <li>Observabilit\u00e9 :</li> <li>Dashboard de statistiques HAProxy (Port 8080).</li> <li>Dashboards analytiques sur Kibana (Port 5601 via tunnel SSH).</li> </ol>"},{"location":"deployment/","title":"D\u00e9ploiement Applicatif &amp; Observabilit\u00e9 (Ansible)","text":"<p>Nous utilisons une approche modulaire bas\u00e9e sur les R\u00f4les Ansible pour orchestrer le cluster.</p>"},{"location":"deployment/#modularite-dependances","title":"Modularit\u00e9 &amp; D\u00e9pendances","text":""},{"location":"deployment/#roles-utilises","title":"R\u00f4les utilis\u00e9s :","text":"<ol> <li>geerlingguy.docker : Provisionnement des n\u0153uds (App et ELK).</li> <li>app : D\u00e9ploiement du conteneur configur\u00e9 avec le driver de logs GELF.</li> <li>haproxy : Installation du LB avec support <code>option forwardfor</code> pour pr\u00e9server l'IP client.</li> <li>elk : D\u00e9ploiement de la stack Elastic (Elasticsearch, Logstash, Kibana) avec parsing Grok.</li> </ol>"},{"location":"deployment/#flux-de-deploiement","title":"Flux de d\u00e9ploiement","text":"<p>Le playbook suit un ordre strict pour garantir la connectivit\u00e9 des logs :</p> <ol> <li>Initialisation Infrastructure : Configuration du noyau (<code>vm.max_map_count</code>) et installation de Docker sur l'ensemble du parc.</li> <li>Provisionnement ELK : Lancement de la stack Elasticsearch/Logstash en priorit\u00e9 pour \u00eatre pr\u00eat \u00e0 recevoir les flux de logs.</li> <li>D\u00e9ploiement App : Lancement du conteneur Olympic Tracker sur les serveurs <code>app_servers</code>. Le driver GELF pointe dynamiquement vers l'IP priv\u00e9e de l'ELK.</li> <li>Configuration LB : Installation de HAProxy, g\u00e9n\u00e9ration dynamique du fichier <code>haproxy.cfg</code> (listant les IPs priv\u00e9es des Apps) et activation du forwarding d'IP r\u00e9elle.</li> <li>Validation &amp; Observabilit\u00e9 : V\u00e9rification de l'ingestion des logs dans Kibana et cr\u00e9ation des index patterns <code>access-logs-*</code>.</li> </ol>"},{"location":"deployment/#pipeline-de-logs-logstash","title":"Pipeline de Logs (Logstash)","text":"<p>Les logs Nginx sont transform\u00e9s en donn\u00e9es structur\u00e9es :</p> <ul> <li>Input GELF : R\u00e9ception des logs Docker sur le port 12201/UDP.</li> <li>Filter Grok : Parsing du format <code>COMBINEDAPACHELOG</code> et enrichissement GeoIP.</li> <li>Indexation : Stockage dans Elasticsearch avec rotation journali\u00e8re (<code>access-logs-%{+YYYY.MM.dd}</code>).</li> </ul>"},{"location":"deployment/#visualisation-kibana","title":"Visualisation (Kibana)","text":"<p>Le dashboard centralise :</p> <ul> <li>Volume de donn\u00e9es : Histogramme de trafic (Sum of bytes) par tranche de 12h.</li> <li>R\u00e9partition des verbes HTTP : Diagramme Donut (GET, POST, etc.).</li> <li>Top Requ\u00eates : Histogramme cumul\u00e9 du Top 5 des endpoints les plus sollicit\u00e9s.</li> </ul>"},{"location":"infrastructure/","title":"D\u00e9tails de l'Infrastructure (Terraform)","text":"<p>L'infrastructure est d\u00e9compos\u00e9e en plusieurs fichiers pour une maintenance granulaire.</p>"},{"location":"infrastructure/#structure-terraform","title":"Structure Terraform","text":"<ul> <li><code>providers.tf</code> : Configuration des sources (AWS, TLS, Local).</li> <li><code>variables.tf</code> : Centralisation des param\u00e8tres (R\u00e9gion, Type d'instance).</li> <li><code>security.tf</code> : Groupes de s\u00e9curit\u00e9 isol\u00e9s (Frontend LB, Backend App, et Stack ELK).</li> <li><code>ssh.tf</code> : G\u00e9n\u00e9ration des cl\u00e9s SSH s\u00e9curis\u00e9es.</li> <li><code>main.tf</code> : D\u00e9finition des instances EC2 (Multi-instances pour l'App, HAProxy et serveur ELK t3.medium).</li> <li><code>ansible.tf</code> : Glue code g\u00e9n\u00e9rant l'inventaire dynamique <code>hosts.yml</code>.</li> </ul>"},{"location":"infrastructure/#securite-reseau","title":"\ud83d\udee1\ufe0f S\u00e9curit\u00e9 &amp; R\u00e9seau","text":"<ul> <li>Isolation R\u00e9seau : Les serveurs applicatifs et ELK utilisent leurs IPs priv\u00e9es.</li> <li>Bastion SSH : L'acc\u00e8s aux serveurs se fait via un rebond (Jump Host) sur l'instance HAProxy.</li> <li>Security Groups :</li> <li><code>haproxy_sg</code> : Ports 80 (Web), 22 (SSH) et 8080 (Stats) ouverts.</li> <li><code>app_sg</code> : Flux restreint au port 80 provenant du LB et SSH via le bastion.</li> <li><code>elk_sg</code> : Ingestion GELF (12201/UDP), Elasticsearch (9200) et Kibana (5601).</li> <li>Cl\u00e9s SSH : Stockage local restreint (<code>0600</code>) et rotation g\u00e9r\u00e9e par Terraform.</li> </ul>"},{"location":"prerequisites/","title":"Pr\u00e9requis et Configuration","text":"<p>Avant de commencer, assurez-vous d'avoir install\u00e9 les outils suivants.</p>"},{"location":"prerequisites/#outils-necessaires","title":"\ud83d\udee0\ufe0f Outils n\u00e9cessaires","text":"<ul> <li>Terraform (v1.14.0+)</li> <li>Ansible (Derni\u00e8re stable)</li> <li>AWS CLI configur\u00e9 avec un profil actif.</li> <li>Mise (optionnel, pour les raccourcis de commandes).</li> </ul>"},{"location":"prerequisites/#configuration-aws","title":"Configuration AWS","text":"<ol> <li>Cr\u00e9ez un utilisateur IAM avec les droits <code>AmazonEC2FullAccess</code>.</li> <li>G\u00e9n\u00e9rez des Access Keys.</li> <li>Configurez votre environnement local :    <pre><code>aws configure\n</code></pre></li> </ol>"},{"location":"prerequisites/#roles-ansible-galaxy","title":"\ud83d\udce6 R\u00f4les Ansible Galaxy","text":"<p>Ce projet utilise des r\u00f4les communautaires pour la fiabilit\u00e9. Installez-les via :</p> <pre><code>ansible-galaxy install -r ansible/requirements.yml -p ansible/roles/\n</code></pre>"},{"location":"usage/","title":"Guide d'Utilisation","text":"<p>Ce guide d\u00e9taille les commandes n\u00e9cessaires pour piloter l'infrastructure.</p>"},{"location":"usage/#gestion-des-secrets","title":"Gestion des Secrets","text":"<p>Avant tout d\u00e9ploiement, assurez-vous que vos secrets sont configur\u00e9s dans <code>ansible/secrets.yml</code> :</p> <pre><code># Pour cr\u00e9er ou \u00e9diter les secrets\nansible-vault edit ansible/secrets.yml\n</code></pre> <p>Le fichier doit contenir :</p> <pre><code>gitlab_user: \"votre_utilisateur\"\ngitlab_token: \"votre_token_personnel\"\n</code></pre>"},{"location":"usage/#execution-avec-mise-recommande","title":"\ud83d\udee0\ufe0f Ex\u00e9cution avec <code>mise</code> (Recommand\u00e9)","text":"<p>Si vous avez install\u00e9 mise, utilisez les raccourcis :</p> Action Commande Appliquer l'infra <code>mise run infra:apply</code> D\u00e9ployer l'app <code>mise run app:deploy</code> D\u00e9truire l'infra <code>mise run infra:destroy</code>"},{"location":"usage/#commandes-manuelles","title":"\ud83d\udcbb Commandes Manuelles","text":"<p>Si vous n'utilisez pas <code>mise</code>, voici les commandes standards :</p>"},{"location":"usage/#1-provisionnement","title":"1. Provisionnement","text":"<pre><code>cd terraform\nterraform init\nterraform apply -auto-approve\n</code></pre>"},{"location":"usage/#2-deploiement-applicatif","title":"2. D\u00e9ploiement Applicatif","text":"<pre><code># \u00c0 la racine du projet\nansible-playbook -i ansible/hosts.yml ansible/deploy.yml --ask-vault-pass\n</code></pre>"},{"location":"usage/#verification","title":"\ud83d\udd0d V\u00e9rification","text":"<p>Une fois d\u00e9ploy\u00e9, l'application est accessible sur le port 80 de l'IP publique de votre instance EC2.</p>"}]}